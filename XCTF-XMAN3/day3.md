# 密码学Day1

## 密码学简介

- 一般来说，密码学的设计者根本目标是保障信息以及信息系统的以下几个方面的特性：
  - 机密性（Confidentiality）、完整性（Integrity）、可用性（Availability）、认证性（Authentication）、不可否认性（Non-repudiation）
- 加密方式
  - 哈希函数：将长度映射成固定长度的信息
- 通用特点与常见破解方式
  - 通用特点：明文密文一一对应
  - 常见破解方式
    - 密钥空间较小，暴力破解 &rarr; 2的32次方左右可以暴力破解
    - 密文长度较长，词频分析
  - 基本工具：CAP4、JPK、CrypTool

## 古典密码

### 凯撒加密

- 破解方式：遍历所有偏移量；词频分析（使用于密文较长的情况）

### 仿射密码

- 仿射密码的加密函数是：`E(x) = (ax+b) (mod m)`

  - x 表示明文按照某种编码得到的数字 。
  - a与m互质。
  - m是编码系统中字母的数目。 

- 仿射密码的解密函数是：`D(x) = a^(-1)*(x-b) (mod m)`

- 破解方式：

  - 一般的仿射密码使用的是字母表，26个字母。

  - 根据欧拉函数：与m互质的a可能取值有

  - *特殊情况*：已知一个参数，可以快速枚举出另一个。例子：

    ```python
    import sys
    key = '****CENSORED***************'
    flag = 'TWCTF{*******CENSORED********}'
    
    if len(key) % 2 == 1:
        print("Key Length Error")
        sys.exit(1)
    
    n = len(key) / 2
    encrypted = ''
    for c in flag:
        c = ord(c)
        for a, b in zip(key[0:n], key[n:2*n]):
            c = (ord(a) * c + ord(b)) % 251
        encrypted += '%02x' % c
    
    print encrypted
    ```

### 多表替换

- Vigenere &rarr; 密钥长度必须与明文一样长
- 其他密码：培根密码、栅栏密码（分组重组）、01248密码（云影密码）、键盘密码

## 对称密码

### 流密码

- 比如：RC4
- 逐字节或者逐比特处理信息

1. 伪随机数生成器（PRNG），依赖于初始值（也称种子）
   - 随机性的严格性 &rarr; 随机性、不可预测性、不可重现性
   - 分类：线性同余生成器（LCG）、线性回归生成器...
2. 反馈移位寄存器：
   - 常见的线性反馈移位函数

### 分组密码

## 块密码



