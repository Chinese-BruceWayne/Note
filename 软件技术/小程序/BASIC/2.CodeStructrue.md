# Code Structrue

上一节的项目中，生成了四个不同的文件：

1. `.json` 后缀的 `JSON` 配置文件；
2. `.wxml` 后缀的 `WXML` 模板文件；
3. `.wxss` 后缀的 `WXSS` 样式文件
4. `.js` 后缀的 `JS` 脚本逻辑文件

## `JSON` 配置文件

我们可以看到在项目的根目录有一个 `app.json` 和 `project.config.json`，此外在 `pages/logs` 目录下还有一个 `logs.json`，我们依次来说明一下它们的用途。

1. 小程序配置 `app.json`：`app.json` 是当前小程序的全局配置，包括了小程序的所有页面路径、界面表现、网络超时时间、底部 tab 等。QuickStart 项目里边的 `app.json` 配置内容如下：

   ```json
   {
     "pages":[
       "pages/index/index",
       "pages/logs/logs"
     ],
     "window":{
       "backgroundTextStyle":"light",
       "navigationBarBackgroundColor": "#fff",
       "navigationBarTitleText": "WeChat",
       "navigationBarTextStyle":"black"
     }
   }
   ```

   1. `pages` 字段 —— 用于描述当前小程序所有页面路径，这是为了让微信客户端知道当前你的小程序页面定义在哪个目录。
   2. `window` 字段 —— 定义小程序所有页面的顶部背景颜色，文字颜色定义等。

   其他配置项细节可以参考文档 [小程序的配置 app.json](https://developers.weixin.qq.com/miniprogram/dev/framework/config.html) 。

2. 工具配置 `project.config.json`：你在工具上做的任何配置都会写入到这个文件，当你重新安装工具或者换电脑工作时，你只要载入同一个项目的代码包，开发者工具就自动会帮你恢复到当时你开发项目时的个性化配置，其中会包括编辑器的颜色、代码上传时自动压缩等等一系列选项。

   其他配置项细节可以参考文档 [开发者工具的配置](https://developers.weixin.qq.com/miniprogram/dev/devtools/projectconfig.html) 。

3. 页面配置 `page.json`：这里的 `page.json` 其实用来表示 pages/logs 目录下的 `logs.json` 这类和小程序页面相关的配置。

   如果你整个小程序的风格是蓝色调，那么你可以在 `app.json` 里边声明顶部颜色是蓝色即可。实际情况可能不是这样，可能你小程序里边的每个页面都有不一样的色调来区分不同功能模块，因此我们提供了 `page.json`，让开发者可以独立定义每个页面的一些属性，例如刚刚说的顶部颜色、是否允许下拉刷新等等。

   其他配置项细节可以参考文档 [页面配置](https://developers.weixin.qq.com/miniprogram/dev/framework/config.html#%E9%A1%B5%E9%9D%A2%E9%85%8D%E7%BD%AE) 。

## `WXML` 模板

`WXML` 充当的是类似 `HTML` 的角色。打开 `pages/index/index.wxml`，你会看到以下的内容:

```html
<view class="container">
  <view class="userinfo">
    <button wx:if="{{!hasUserInfo && canIUse}}">获取头像昵称</button>
    <block wx:else>
      <image src="{{userInfo.avatarUrl}}" background-size="cover"></image>
      <text class="userinfo-nickname">{{userInfo.nickName}}</text>
    </block>
  </view>
  <view class="usermotto"><text class="user-motto">{{motto}}</text></view>
</view>
```

与 `html` 的不同点：

1. 标签的名字不一样。更多详细的组件讲述参考下个章节 [小程序的能力](https://developers.weixin.qq.com/miniprogram/dev/quickstart/basic/framework.html)

2. 多了一些 `wx:if` 这样的属性以及 `{{ }}` 这样的表达式。

   例如，`wxml` 是这么写的：

   ```html
   <text>{{msg}}</text>
   ```

   JS 只需要通过以下的方式管理状态就可以了：

   ```javascript
   this.setData({msg: 'Hello World'})
   ```

   此外你可能还需要 `if/else` `for` 语句这样的控制能力，在小程序里，这些控制能力都用 `wx:` 开头的属性表示。更详细的文档可以参考 [WXML](https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/index.html)

## `WXSS` 样式

`WXSS` 具有 `CSS` 大部分的特性，小程序在 `WXSS` 也做了一些扩充和修改。

1. `WXSS` 在底层支持新的**尺寸单位 `rpx`** ，开发者可以免去换算的烦恼，只要交给小程序底层来换算即可，由于换算采用的浮点数运算，所以运算结果会和预期结果有一点点偏差。
2. 提供了全局的样式和局部样式。和前边 `app.json`, `page.json` 的概念相同，你可以写一个 `app.wxss` 作为全局样式，会作用于当前小程序的所有页面，局部页面样式 `page.wxss` 仅对当前页面生效。
3. 此外 `WXSS` 仅支持部分 `CSS` 选择器

更详细的文档可以参考 [WXSS](https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxss.html) 。

## `JS` 交互逻辑

在小程序里边，通过编写 `JS` 脚本文件来处理用户的操作。

比如，`wxml` 中写入这样一段代码：

```html
<view>{{ msg }}</view>
<button bindtap="clickMe">点击我</button>
```

点击 `button` 按钮的时候，我们希望把界面上 `msg` 显示成 `"Hello World"`，于是我们在 `button` 上声明一个属性: `bindtap`，在 JS 文件里边声明了 `clickMe` 方法来响应这次点击操作：

```javascript
Page({
  clickMe() {
    this.setData({msg: 'Hello World'})
  }
})
```

响应用户的操作就是这么简单，更详细的事件可以参考文档 [WXML - 事件](https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/event.html) 。

此外你还可以在 JS 中调用小程序提供的丰富的 API，利用这些 API 可以很方便的调起微信提供的能力，例如获取用户信息、本地存储、微信支付等。在前边的例子中，在 `pages/index/index.js` 就调用了 [`wx.getUserInfo`](https://developers.weixin.qq.com/miniprogram/dev/api/wx.getUserInfo.html) 获取微信用户的头像和昵称，最后通过 `setData` 把获取到的信息显示到界面上。更多 API 可以参考文档 [小程序的API](https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/api.html) 。

