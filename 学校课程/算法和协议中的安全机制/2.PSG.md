# Chapter 2. Pseudorandom Sequence Generators

## Finite Field

需要一个随机性、算法速度兼顾的算法。

所以我们考虑以下的运算：异或、移位、加减法、布尔函数...

定义（Finite Field）：记作 $$\mathbb{F}_n$$

- 对于 `+` 运算：存在 `0` 元；对于任意元素，存在一个其加法运算的负元。
- 对于 `*` 运算：存在 `1` 元；对于任意元素，存在一个其乘法的逆元。

定理：

- 对于 p 是素数，$$\mathbb{Z}_p = \mathbb{F}_p$$

- Expansion：$$\displaystyle \mathbb{F}_p \Rightarrow \mathbb{F}_{p^n}$$

如何从 $$\mathbb{F}_2$$ 构造 $$\mathbb{F}_{2^n}$$：

- 令 $$GF(2^n) = \{x_0 + x_1 \alpha + ... + x_{n-1} \alpha^{n-1}\text{, where } x_i \in \mathbb{F_2}\}$$

- 那么我们可以构造：$$\displaystyle \mathbb{F}_4 = \frac{GF(2)[x]}{p(x)}\text{, where }\deg{p(x)} = n, p(x):irreducible​$$

表示方法：

- polynomial representation:$$x_0 + x_1\alpha + x_2 \alpha^2 +... + x_{n-1}\alpha^{n-1}​$$
- vector based representation:$$(x_0, x_1,..., x_{n-1})$$
- Exponential representation:$$\{\alpha^i, i = 0,1,...,2^{n}-2\}$$

定义（Multiplicative Group）：

- $$\displaystyle GF(2^n)^{*} = GF(2^n)\text{\\}\{0\} = \{\alpha^i, i = 0,1,...,2^{n}-2\}$$

## Group

定义：

1. Associative: $$a * (b*c) = (a*b)*c$$

2. Identity: $$\exist e \in G, a*e = e*a = a$$
3. $$\forall a \in G, \exist a^{-1}, \text{so that }a * a^{-1} = e$$
4. $$\text{For }a, b \in G, a*b = b*a \Rightarrow$$ Commutative Group 交换群

## Primitive

定义：考虑在 $$GF(2^n)^*$$ 中：

- $$ord \beta​$$: the least integer m such that $$\beta^m = 1​$$

- primitive: We say $$\beta​$$ is primitive if $$ord \beta = 2^n - 1​$$

定理：

- $$\alpha$$ is a root of $$f(x)$$, then $$\alpha^{2^i}, i = 0,1,...,n-1$$ are root of $$f(x)$$

- $$\displaystyle ord \alpha^s = \frac{ord \alpha}{gcd(s, ord \alpha)}$$

## Feedback Shift Register Sequences

### Maximum Periods

我们发现：

- Output bits are closely related to `feedback function`, and `internal states`

What is the maximum period of an n-stage FSR sequence?

- Period: $$2^n - 1$$, `de bruijin sequences`

### m-sequence

定义：

- $$f(x_0, x_1, ..., x_{n-1}) = c_{n-1}x_{n-1} +... +c_1x_1 + c_0 x_0 \leftrightarrow f(x) = x^n + c_{n-1}x^{n-1} +... +c_1x^1 + c_0 x^0$$

- f(x) is called `characteristic polynomial 特征多项式`

性质：

- 定义操作符 L：$$(a_0, a_1, ..., a_{n-1}) \rightarrow (a_1, a_2, ..., a_n)​$$

- 对于特征多项式，我们总有：$$\displaystyle f(L)*\overset{\rightarrow}{a} = 0​$$

性质：

- The minimal polynomial of an LFSR is a `divisor` of its characteristic polynomial.

性质：

- 如果 f(x), g(x) 是特征多项式，我们有：$$f(x) + g(x), x^i *f(x), h(x) * f(x)​$$ 也是特征多项式

性质：

- The period of the sequence $$\{a_i\}$$ is equal to the period of its minimal polynomial.

有 Caylor-Hamilton Theorem：

- 对于 FSRS 的转移矩阵 M，

- If $$f(x) | x^r -1 \Rightarrow M^r = I \Rightarrow$$ Internal state repeats at the period `r`

定义：

- 如果我们连个 LFSR 通过同一个转移函数得到，则我们称他们为 `shift equivalent`

### linear span

定义：

- An LFSR s said to generate a finite sequence $$a_0, a_1, ..., a_{N-1}$$ when the this sequence conincides  with the first N output elements of l-stage LFSR for the initial state $$(a_0, a_1,...,a_{l-1})$$. The shortest length of the LFSR which generate $$a^N$$ is called the linear span of $$a^N$$.

