# Chapter 4. Design of Block Ciphers, Hash Functions, and MAC

## Block Cipher

property:

- Diffusion: any bits from the input message should affect whole cipher text.
- Confusion: with different key, the cipher message should be completely different.

Requirements of `f`:

- `Nonelinearity`: a minimum distance between `f` and all the linear, affine functions. Resist linear cryptanalysis.
- `Strict Avalanche Criterion(SAC)`: One bit change, resulting in significant changes. Resist differential cryptanalysis.

### DES

`DES` stand for `Data Encryption Standard`.

Spectral properties of S-Box:

- Hadamard transform: $$\displaystyle f(w) = \sum_{x \in F_2^n} (-1)^{f(x) + xw}$$
- Avalanche transform: $$\displaystyle A(w) = \sum_{x \in F_2^n} (-1)^{f(x) + f(x + w)}$$

Triple-DES: $$C = E_{K_3} (D_{K_2} (E_{K_1}(M)))$$ or $$C = D_{K_3} (E_{K_2} (D_{K_1}(M)))$$

Encryption Modes:

1. Electronic Codebook (`ECB`) Mode => Security risks.
2. Cipher Block Chaining (`CBC`) Mode.

### Montgomery Ladder

A compute algorithm that resist side-chanel attack.

```pseudocode
function f(g, k):
	// g=>number, k=>(k[t-1], ..., k[0])_2
	R0, R1 = 1, g
	for j in range(t)[::-1]:
		if k[j] == 0:
			R1 = R0*R1, R0 = R0*R0
		else if k[j] == 1:
			R0 = R0*R1, R1 = R0*R0
		else:
			assert False
	return R0
```

### `A5/1` in GSM system

Weaknesses and Attack:

1. Short period.
2. Majority Rule.
3. Short Key length.

### RC4

`KIA & PRSG`ï¼š

```pseudocode
KIA(K)
Initialization:
	for i in range(2^n):
		S[i] = i
Scrambling:
	j = 0
	for i in range(2^n):
		j = j + S[i] + K[i % l]
		swap(S[i], S[j])
```

### AES

### `Stream Cipher & Block Cipher`

Block Cipher: more computationally costly.

Stream Cipher: More desired randomness properties.

## Hash Functions

Why Hash?

- Save Storage
- Efficient
- Additional information for integrity check

Hash Standards:

- MD5, Rivest
- SHA-1
- SHA-2
- SHA-3 Kecchak

### SHA-1

## MAC

MAC is used for providing authenticity of a user or source originality.

